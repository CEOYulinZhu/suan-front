<!--pages/practice-daily/practice-daily.wxml-->


<view class="container">
 
    <!-- è¿ç»­æ‰“å¡è®°å½• -->
    <view class="check-in" wx:if="{{showCheck}}">
        <view class="check-in-icon">ğŸ”¥{{checkInDays}}</view>
        <view class="check-in-days">
            <text class="check-in-days-titile"> è¿ç»­æ‰“å¡</text>
            <text class="check-in-days-text">åšæŒæ¯å¤©ç»ƒä¹ è·å¾—å¥–åŠ±</text>
        </view>
        
    </view>
    
    <!-- ä»Šæ—¥è¿›åº¦ -->
    <view class="progress-section" wx:if="{{showProgres}}">
        <view class="progress-header">
            <text class="progress-title">ä»Šæ—¥è¿›åº¦</text>
            <navigator url="/pages/check-in-records/check-in-records" class="records-link">
                <text class="records-icon">ğŸ“‹</text>
                <text class="records-text" bindtap="toggleCalendar">æ‰“å¡è®°å½•</text>
            </navigator>
        </view>
        <view class="progress-bar">
            <view class="progress-fill" style="width: {{currentQuestionIndex*10}}%"></view>
        </view>
        <view class="progress-info">
            <text class="progress-count">{{currentQuestionIndex}}/{{total}}</text>
            <text class="progress-desc">è¿˜éœ€å®Œæˆ {{total-currentQuestionIndex}} é¢˜</text>
        </view>
        <button class="continue-practice" bindtap="showPractice">ç»§ç»­ç»ƒä¹ </button>
    </view>   

    <!-- ç»ƒä¹ å†…å®¹åŒºåŸŸ -->
    <view class="test-container" wx:if="{{showPractice}}">
        <view class="progress-bar">
            <view class="progress-fill" style="width: {{currentQuestionIndex*10}}%"></view>
        </view>
        <view class="test">
                <view class="test-text">ç¬¬{{currentQuestionIndex}}é¢˜/å‰©ä½™{{total-currentQuestionIndex}}é¢˜</view>

            <view class="current-question" wx:if="{{currentQuestionIndex!=10}}"> 
                <text class="question-text">{{currentQuestion.num1}} {{currentQuestion.operator}} {{currentQuestion.num2}} = </text>
                <input 
                class="answer-input" 
                type="number" 
                placeholder="è¯·è¾“å…¥ç­”æ¡ˆ" 
                value="{{currentQuestion.userAnswer}}" 
                bindinput="onAnswerInput"
                />
            </view>

        <view class="result-tip" wx:if="{{showResult}}">
            <text class="{{resultType}}">{{resultMessage}}</text>
            <text wx:if="{{!isComplete}}">æ­£ç¡®ç­”æ¡ˆï¼š{{currentQuestion.correctAnswer}}</text>
        </view>
                <image 
                wx:if="{{isComplete}}" 
                src="/assets/gif/celebration.gif" 
                mode="widthFix" 
                class="gif-image"
                ></image>
                <view wx:if="{{isComplete}}" class="complete-tip">
                    <text>å…¨éƒ¨é¢˜ç›®å®Œæˆï¼</text>
                    
                </view>
            <view class="button-group">
                <button 
                class="next-btn" 
                wx:if="{{!isComplete}}" 
                bindtap="checkAnswer"
                >
                {{isChecking ? 'å‡ºé¢˜...' : 'æäº¤ç­”æ¡ˆ'}}
                </button>

                <view class="next-time" bindtap="nextTime"  wx:if="{{currentQuestionIndex!=10}}">
                    æš‚æ—¶ç¦»å¼€
                </view>
                <view class="next-day" bindtap="nextTime"  wx:if="{{currentQuestionIndex===10}}">
                    è¿”å›
                </view>
            </view>
        </view>        
        <view class="test-detail">
            <view class="test-detai2">
                <view class="detail-title">
                <text >å½“å‰è¿›åº¦</text>
                </view>
                <view class="detail-label">
                <text lass="detail-sum">æ€»è¿›åº¦</text>
                <text >{{currentQuestionIndex}}/{{total}}</text>
                </view>
                <view class="detail-label">
                <text>æœ¬æ¬¡æ­£ç¡®</text>
                <text class="detail-value">{{correctCount}}é¢˜</text>
                </view>
                <view class="detail-label">
                <text>æœ¬æ¬¡é”™è¯¯</text>
                <text class="detail-value">{{errorCount}}é¢˜</text>
            
                </view>
            </view>
            
        </view>
    </view>

    <!-- æ—¥å† -->
    <view class="calendar-section" wx:if="{{showCalendar}}">
        <text class="calendar-title">æ‰“å¡æ—¥å†</text>
        <view class="calendar-header">
            <text class="calendar-nav" bindtap="prevMonth">ã€Š</text>
            <text class="calendar-nav" bindtap="prevMonth">ã€ˆ</text>
            <text class="calendar-month">{{currentMonth}}</text>
            <text class="calendar-nav" bindtap="nextMonth">ã€‰</text>
            <text class="calendar-nav" bindtap="nextMonth">ã€‹</text>
        </view>
        <view class="calendar-weekdays">
            <text>æ—¥</text>
            <text>ä¸€</text>
            <text>äºŒ</text>
            <text>ä¸‰</text>
            <text>å››</text>
            <text>äº”</text>
            <text>å…­</text>
        </view>
        <view class="calendar-days">
                <block wx:for="{{calendarDays}}" wx:key="index">
                <view class="calendar-day {{item.month === 'current' ? '' : 'gray'}} {{item.checked ? 'checked' : ''}} {{item.isToday ? 'is-today' : ''}}">
                    <text>{{item.day}}</text>
                </view>
                </block>
        </view>
    </view>
    

     <!-- æ‰“å¡å¥–åŠ± -->
    <view class="rewards-section"  wx:if="{{showRewards}}">
        <text class="rewards-title">æ‰“å¡å¥–åŠ±</text>
        <view class="reward-item">
            <text class="reward-days">è¿ç»­3å¤©</text>
            <text class="reward-points">é‡‘å¸ +30</text>
        </view>
        <view class="reward-item">
            <text class="reward-days">è¿ç»­7å¤©</text>
            <text class="reward-points">é‡‘å¸ +100</text>
        </view>
        <view class="reward-item">
            <text class="reward-days">è¿ç»­15å¤©</text>
            <text class="reward-points">é‡‘å¸ +200 + è§£é”ç‰¹æ®Šé¢˜åº“</text>
        </view>
        <view class="reward-item">
            <text class="reward-days">è¿ç»­30å¤©</text>
            <text class="reward-points">é‡‘å¸ +500 + é™å®šå¾½ç« </text>
        </view>
    </view>


</view>