<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="top-nav">
    <view class="nav-item" data-tab="äº’åŠ¨ç»ƒä¹ " bindtap="switchTab" wx:class="{{currentPage === 'äº’åŠ¨ç»ƒä¹ ' ? 'active' : ''}}">äº’åŠ¨ç»ƒä¹ </view>
    <view class="nav-item" data-tab="å¯è§†åŒ–å­¦ä¹ " bindtap="switchTab" wx:class="{{currentPage === 'å¯è§†åŒ–å­¦ä¹ ' ? 'active' : ''}}">å¯è§†åŒ–å­¦ä¹ </view>
    <view class="nav-item" data-tab="å‘è€å¸ˆæé—®" bindtap="switchTab" wx:class="{{currentPage === 'å‘è€å¸ˆæé—®' ? 'active' : ''}}">å‘è€å¸ˆæé—®</view>
    <view class="nav-item" data-tab="å­¦ä¹ è¿›åº¦" bindtap="switchTab" wx:class="{{currentPage === 'å­¦ä¹ è¿›åº¦' ? 'active' : ''}}">å­¦ä¹ è¿›åº¦</view>
  </view>
  
  <!-- äº’åŠ¨ç»ƒä¹ é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'äº’åŠ¨ç»ƒä¹ '}}" class="page-container" scroll-y="{{true}}">
    <view class="practice-container">
      <!-- ä»Šæ—¥æŒ‘æˆ˜ -->
      <view class="challenge">
        <text class="section-title">ğŸ²ä»Šæ—¥æŒ‘æˆ˜</text>
        <view class="question">{{question.num1}} + {{question.num2}} = ?</view>
        <view class="options">
          <view class="option" data-value="{{item}}" bindtap="checkAnswer" wx:class="{{question.selectedOption === item ? (question.isCorrect ? 'correct' : 'incorrect') : ''}}" wx:for="{{question.options}}" wx:key="index">{{item}}</view>
        </view>
        <button class="btn-change" bindtap="generateNewQuestion" wx:if="{{!question.isCorrect}}">æ¢ä¸€é¢˜</button>
        <button class="btn-next" bindtap="nextQuestion" wx:if="{{question.isCorrect}}">ä¸‹ä¸€é¢˜</button>
        
        <!-- ç­”é¢˜ç»“æœæç¤º -->
        <view class="result-tip" wx:if="{{question.selectedOption !== null}}">
          <view wx:if="{{question.isCorrect}}" class="correct-tip">
            <text class="result-text">ç­”å¯¹äº†ï¼ğŸ‘</text>
            <text class="tip-content">åŠ æ³•è®¡ç®—æŠ€å·§ï¼šå…ˆç®—æ•´åæ•°ï¼Œå†åŠ å„ä½æ•°</text>
          </view>
          <view wx:if="{{!question.isCorrect}}" class="incorrect-tip">
            <text class="result-text">æ­£ç¡®ç­”æ¡ˆæ˜¯: {{question.answer}}</text>
            <text class="tip-content">åŠ æ³•è®¡ç®—æŠ€å·§ï¼šå…ˆç®—æ•´åæ•°ï¼Œå†åŠ å„ä½æ•°</text>
          </view>
        </view>
      </view>
      
      <!-- è¶£å‘³è§†é¢‘ -->
      <view class="fun-video">
        <text class="section-title">ğŸ“·ï¸è¶£å‘³è§†é¢‘è®²è§£</text>
        <swiper class="video-swiper" indicator-dots="{{true}}" autoplay="{{false}}" interval="{{5000}}" duration="{{500}}" bindchange="changeVideo">
          <swiper-item wx:for="{{videos}}" wx:key="index">
            <image src="{{item}}" mode="aspectFill"></image>
          </swiper-item>
        </swiper>
        <view class="video-tip">æ•°å­¦åŠ é€ŸæŠ€å·§</view>
      </view>
    </view>
  </scroll-view>
  
  <!-- å¯è§†åŒ–å­¦ä¹ é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å¯è§†åŒ–å­¦ä¹ '}}" class="page-container" scroll-y="{{true}}">
    <view class="visualization-container">
      <view class="visualization-content">
        <text class="section-title">ğŸ²å¯è§†åŒ–å­¦ä¹ </text>
        <view class="question">{{question.num1}} + {{question.num2}} = ?</view>
        <!-- å°æŠ€å·§æç¤º -->
        <view class="tip-tag-container">
          <text class="tip-tag">è®¡ç®—å°æŠ€å·§ï¼šæ‹†åˆ†æ³•</text>
        </view>
        
        <!-- åŸå§‹æ•°å­— -->
        <view class="original-numbers-container">
          <text class="original-numbers-title">åŸå§‹æ•°å­—</text>
          <view class="number-group">
            <text class="big-number">{{question.num1}}</text>
            <text class="plus">+</text>
            <text class="big-number">{{question.num2}}</text>
          </view>
          <view class="number-beads">
            <view class="bead-group">
              <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]}}" wx:key="index" wx:if="{{index < question.num1}}" class="bead-with-number">
                <text class="number">{{index + 1}}</text>
              </view>
            </view>
            <text class="plus-sign">+</text>
            <view class="bead-group">
              <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]}}" wx:key="index" wx:if="{{index < question.num2}}" class="bead-with-number">
                <text class="number">{{index + 1}}</text>
              </view>
            </view>
          </view>
        </view>
        
        <!-- æ‹†åˆ†è¿ç®— -->
        <view class="decomposition-container">
          <text class="decomposition-title">æ‹†åˆ†è¿ç®—
            <text class="decomposition-subtitle">æŠŠæ•°å­—æ‹†æˆåä½å’Œä¸ªä½</text>
          </text>
          
          <view class="equation">{{question.num1}} = <text class="highlight">{{visualize.tens1}}</text> + <text class="highlight">{{visualize.ones1}}</text></view>
          <view class="equation">{{question.num2}} = <text class="highlight">{{visualize.tens2}}</text> + <text class="highlight">{{visualize.ones2}}</text></view>
          <view class="parts">
            <view class="part">
              <text>åä½: {{visualize.tens1}}</text>
              <!-- åä½ç å­ -->
              <view class="tens-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9,10]}}" wx:key="index" wx:if="{{index < visualize.tens1}}" class="tens-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
              <text class="tens-label">{{visualize.tens1}}Ã—1</text>
            </view>
            <view class="part">
              <text>ä¸ªä½: {{visualize.ones1}}</text>
              <!-- ä¸ªä½ç å­ -->
              <view class="ones-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9]}}" wx:key="index" wx:if="{{index < visualize.ones1}}" class="ones-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
            </view>
            <view class="part">
              <text>åä½: {{visualize.tens2}}</text>
              <!-- åä½ç å­ -->
              <view class="tens-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9,10]}}" wx:key="index" wx:if="{{index < visualize.tens2}}" class="tens-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
              <text class="tens-label">{{visualize.tens2}}Ã—1</text>
            </view>
            <view class="part">
              <text>ä¸ªä½: {{visualize.ones2}}</text>
              <!-- ä¸ªä½ç å­ -->
              <view class="ones-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9]}}" wx:key="index" wx:if="{{index < visualize.ones2}}" class="ones-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
        
        <!-- è®¡ç®—æ‹†åˆ†åçš„åŠ æ³• -->
        <view class="calculation-container">
          <text class="calculation-title">è®¡ç®—æ‹†åˆ†ä¹‹åçš„åŠ æ³•</text>
          <view class="step-container">
            <view class="step-item">
              <text class="step-text">{{visualize.tens1}} + {{visualize.tens2}} = <text class="highlight">{{visualize.sumTens}}</text> (åä½ç›¸åŠ )</text>
            </view>
            <view class="step-item">
              <text class="step-text">{{visualize.ones1}} + {{visualize.ones2}} = <text class="highlight">{{visualize.sumOnes}}</text> (ä¸ªä½ç›¸åŠ )</text>
            </view>
            <view class="step-item">
              <text class="step-text">{{visualize.sumTens}} + {{visualize.sumOnes}} = <text class="highlight">{{visualize.sumTotal}}</text> (ç»“æœ)</text>
            </view>
          </view>
        </view>
        
        <!-- è§£é¢˜æ­¥éª¤ -->
        <view class="steps-container">
          <text class="steps-title">è§£é¢˜æ­¥éª¤</text>
          <view class="step-item">
            <text class="step-number">1</text>
            <text class="step-text">å°†{{question.num1}}æ‹†åˆ†ä¸º{{visualize.tens1}} + {{visualize.ones1}}ï¼Œå°†{{question.num2}}æ‹†åˆ†ä¸º{{visualize.tens2}} + {{visualize.ones2}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">2</text>
            <text class="step-text">è®¡ç®—åä½æ•°ç›¸åŠ ï¼š{{visualize.tens1}} + {{visualize.tens2}} = {{visualize.sumTens}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">3</text>
            <text class="step-text">è®¡ç®—ä¸ªä½æ•°ç›¸åŠ ï¼š{{visualize.ones1}} + {{visualize.ones2}} = {{visualize.sumOnes}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">4</text>
            <text class="step-text">å°†ç»“æœç›¸åŠ ï¼š{{visualize.sumTens}} + {{visualize.sumOnes}} = {{visualize.sumTotal}}</text>
          </view>
        </view>
        
        <!-- æœ€ç»ˆç»“æœ -->
        <view class="final-result-container">
          <text class="final-result-title">æœ€ç»ˆç»“æœ</text>
          <view class="result-equation">{{question.num1}} + {{question.num2}} = <text class="result">{{visualize.sumTotal}}</text></view>
          <!-- ç»“æœç å­ -->
          <view class="result-beads">
            <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]}}" wx:key="index" wx:if="{{index < visualize.sumTotal}}" class="result-bead-with-number">
              <text class="number">{{index + 1}}</text>
            </view>
          </view>
        </view>
        
        <button class="btn-change" bindtap="generateNewQuestion">æ¢ä¸€é¢˜</button>
      </view>
    </view>
  </scroll-view>
  
  <!-- å‘è€å¸ˆæé—®é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å‘è€å¸ˆæé—®'}}" class="page-container" scroll-y="{{true}}">
      <view class="question-container">
      <view class="chat-container">
        <view class="message assistant">
          <view class="avatar">
            <image src="/assets/ai/avatar-assistant.png"></image>
          </view>
          <view class="content">
            <text class="name">æ•°å­¦æ™ºèƒ½åŠ©æ‰‹ 
              <text class="status">åœ¨çº¿ï¼Œå¯ä»¥æé—®</text>
            </text>
            
            <text class="time">20:49</text>
          </view>
        </view>
        <view class="message assistant">
          <view class="avatar">
            <image src="/assets/ai/avatar-assistant.png"></image>
          </view>
          <view class="content">
            <text class="message-text">ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIæ•°å­¦è€å¸ˆï¼Œæˆ‘å¯ä»¥å¸®ä½ è§£å†³å£ç®—é—®é¢˜ï¼Œæä¾›å¯è§†åŒ–è§£é‡Šï¼è¯•è¯•é—®æˆ‘"æ€ä¹ˆè®¡ç®—25+17?"</text>
            <text class="time">20:49</text>
          </view>
        </view>
      </view>
      
      <view class="input-container">
          <input class="input" placeholder="ä¾‹å¦‚ï¼šæ€ä¹ˆè®¡ç®—25+17?" value="{{userMessage}}" bindinput="onInput" />
          <button class="btn-send" bindtap="sendMessage">å‘é€</button>
      </view>
      
      <view class="popular-questions">
        <text class="section-title">â­çƒ­é—¨é—®é¢˜</text>
        <view class="question-tags">
          <text class="tag">æ€ä¹ˆè®¡ç®—25+17?</text>
          <text class="tag">è¿›ä½åŠ æ³•æ€ä¹ˆç®—?</text>
          <text class="tag">è¿åŠ é¢˜æœ‰ä»€ä¹ˆæŠ€å·§?</text>
          <text class="tag">é€€ä½å‡æ³•æ€ä¹ˆæ•™å­©å­?</text>
        </view>
      </view>
    </view>
  </scroll-view>
  
  <!-- å­¦ä¹ è¿›åº¦é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å­¦ä¹ è¿›åº¦'}}" class="page-container" scroll-y="{{true}}">
    <view class="progress-container">
      <!-- ä¸ªäººå­¦ä¹ è¿›åº¦ -->
      <view class="personal-progress">
        <text class="section-title">ğŸ‘¤ä¸ªäººå­¦ä¹ è¿›åº¦</text>
        
        <view class="progress-item">
          <text class="progress-label">âšæ€»ä½“æŒæ¡åº¦</text>
          <progress percent="{{progress.overall}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.overall}}%</text>
        </view>
        
        <view class="progress-item">
          <text class="progress-label">ğŸ—ŠåŠ æ³•è¿›ä½</text>
          <progress percent="{{progress.addition}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.addition}}%</text>
        </view>
        
        <view class="progress-item">
          <text class="progress-label">ğŸ—Šè¿åŠ è¿å‡</text>
          <progress percent="{{progress.consecutive}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.consecutive}}%</text>
        </view>
        
        <view class="progress-item">
          <text class="progress-label">ğŸ—Šä¹˜æ³•å£è¯€</text>
          <progress percent="{{progress.multiplication}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.multiplication}}%</text>
        </view>
        
        <view class="progress-item">
          <text class="progress-label">ğŸ—Šåº”ç”¨é¢˜è§£æ</text>
          <progress percent="{{progress.application}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.application}}%</text>
        </view>
      </view>
      
      <!-- ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’ -->
      <view class="learning-plan">
        <text class="section-title">â­ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’</text>
        
        <view class="recommended-paths">
          <text class="path-title">  ğŸ—€æ¨èå­¦ä¹ è·¯å¾„</text>
          
          <view class="path-item">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/AI/math-icon.png"></image>
              </view>
              <view class="path-info">
                <text class="path-name">åŠ æ³•è¿›ä½ä¸“é¢˜</text>
                <text class="path-status">è¿›è¡Œä¸­ 3/5</text>
                <text class="path-description">æŒæ¡åŠ æ³•è¿›ä½çš„åŸç†å’Œæ–¹æ³•</text>
              </view>
            </view>
            <button class="btn-continue">ç»§ç»­å­¦ä¹ </button>
          </view>
          
          <view class="path-item">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/AI/math-icon.png"></image>
              </view>
              <view class="path-info">
                <text class="path-name">é€€ä½å‡æ³•ä¸“é¢˜</text>
                <text class="path-status">è¿›è¡Œä¸­ 1/5</text>
                <text class="path-description">å­¦ä¹ é€€ä½å‡æ³•çš„è®¡ç®—æŠ€å·§</text>
              </view>
            </view>
            <button class="btn-continue">ç»§ç»­å­¦ä¹ </button>
          </view>
          
          <view class="path-item">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/AI/math-icon.png"></image>
              </view>
              <view class="path-info">
                <text class="path-name">æ··åˆè¿ç®—ä¸“é¢˜</text>
                <text class="path-status">æœªå¼€å§‹</text>
                <text class="path-description">ç»¼åˆè¿ç”¨åŠ å‡æ³•è§£å†³é—®é¢˜</text>
              </view>
            </view>
            <button class="btn-start">å¼€å§‹å­¦ä¹ </button>
          </view>
        </view>
        
        <button class="btn-full-plan">æŸ¥çœ‹å®Œæ•´å­¦ä¹ è®¡åˆ’</button>
      </view>
    </view>
  </scroll-view>
</view>