<view class="ai-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="nav">
    <view 
      wx:for="{{navItems}}" 
      wx:key="index" 
      class="nav-item {{currentActiveIndex === index ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="{{item}}"
      data-index="{{index}}"
    >
      {{item}}
    </view>
  </view>

  <!-- äº’åŠ¨ç»ƒä¹ é¡µé¢ -->
<view wx:if="{{currentPage === 'äº’åŠ¨ç»ƒä¹ '}}" class="page-container" scroll-y="{{true}}" show-scrollbar="{{false}}">
  <!-- ä»Šæ—¥æŒ‘æˆ˜ -->
  <view class="challenge">
        <view class="bmpJRA">
          <image src="/assets/ai/math-icon.svg" style="width: 15px; height: 15px;"></image>ä»Šæ—¥æŒ‘æˆ˜
        </view>
        <view class="question">{{question.num1}} + {{question.num2}} = ?</view>
        <view class="options">
          <view
            wx:for="{{question.options}}"
            wx:key="index"
            class="option {{item === question.selectedOption ? (question.isCorrect ? 'correct' : (item === question.answer ? 'correct' : 'incorrect')) : ''}}"
            bindtap="selectOption"
            data-value="{{item}}"
          >
            {{item}}
          </view>
        </view>
        
        <!-- æŒ‰é’®æ˜¾ç¤ºé€»è¾‘ -->
        <button 
          wx:if="{{question.selectedOption !== null && question.isCorrect}}" 
          class="btn-change" 
          bindtap="nextQuestion"
        >
          ä¸‹ä¸€é¢˜
        </button>
        <button 
          wx:if="{{question.selectedOption !== null && !question.isCorrect}}" 
          class="btn-change" 
          bindtap="nextQuestion"
        >
          ä¸‹ä¸€é¢˜
        </button>
        <button 
          wx:if="{{question.selectedOption === null}}" 
          class="btn-change" 
          bindtap="generateNewQuestion"
        >
          æ¢ä¸€é¢˜
        </button>
        
        <!-- ç­”é¢˜ç»“æœæç¤º -->
        <view class="result-tip" wx:if="{{question.selectedOption !== null}}">
          <view wx:if="{{question.isCorrect}}" class="correct-tip">
              <text class="result-text">ç­”å¯¹äº†ï¼ğŸ‘</text>
              <view class="tip-content">åŠ æ³•è®¡ç®—æŠ€å·§ï¼šå…ˆç®—æ•´åæ•°ï¼Œå†åŠ å„ä½æ•°</view>
          </view>
          <view wx:if="{{!question.isCorrect}}" class="incorrect-tip">
              <text class="result-text">æ­£ç¡®ç­”æ¡ˆæ˜¯: {{question.answer}}</text>
              <view class="tip-content">åŠ æ³•è®¡ç®—æŠ€å·§ï¼šå…ˆç®—æ•´åæ•°ï¼Œå†åŠ å„ä½æ•°</view>
          </view>
        </view>
    </view>
  
   <!-- è¶£å‘³è§†é¢‘è®²è§£ -->
   <view class="fun-video">
    <view class="bmpJRA">
      <image src="/assets/AI/camera.svg" style="width: 16px; height: 16px;"></image>è¶£å‘³è§†é¢‘è®²è§£
    </view>
    <swiper class="video-swiper" indicator-dots="{{true}}" autoplay="{{false}}" interval="{{5000}}" duration="{{500}}" bindchange="changeVideo">
        <swiper-item wx:for="{{videos}}" wx:key="index">
            <image src="{{item}}" mode="aspectFill"></image>
        </swiper-item>
    </swiper>
    <view class="video-tip">æ•°å­¦åŠ é€ŸæŠ€å·§</view>
</view>
</view>
  
  <!-- å¯è§†åŒ–å­¦ä¹ é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å¯è§†åŒ–å­¦ä¹ '}}" class="page-container" scroll-y="{{true}}" show-scrollbar="{{false}}">
    <!-- å¯è§†åŒ–å­¦ä¹ é¡µé¢å†…å®¹ -->
    <view class="visualization-container">
      <view class="visualization-content">
        <view class="bmpJRA">
          <image src="/assets/ai/image.svg" style="width: 15px; height: 15px;"></image>å¯è§†åŒ–å­¦ä¹ 
        </view>
        <view class="question">{{question.num1}} + {{question.num2}} = ?</view>
        <!-- å°æŠ€å·§æç¤º -->
        <view class="tip-tag-container">
          <text class="tip-tag">è®¡ç®—å°æŠ€å·§ï¼šæ‹†åˆ†æ³•</text>
        </view>
        
        <!-- åŸå§‹æ•°å­—æ¨¡å— -->
        <view class="module-container original-numbers-container">
          <text class="diOOcZ">åŸå§‹æ•°å­—</text>
            <view class="number-group">
                <text class="big-number">{{question.num1}}</text>
                <text class="plus">+</text>
                <text class="big-number">{{question.num2}}</text>
            </view>
            <view class="number-beads">
                <view class="bead-row">
                    <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]}}" wx:key="index" wx:if="{{index < question.num1}}" class="bead-with-number" wx:class="{{index % 10 === 0 ? 'last-in-row' : ''}}">
                        <text class="number">{{index + 1}}</text>
                    </view>
                </view>
                <text class="plus-sign">+</text>
                <view class="bead-row">
                    <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]}}" wx:key="index" wx:if="{{index < question.num2}}" class="bead-with-number" wx:class="{{index % 10 === 0 ? 'last-in-row' : ''}}">
                        <text class="number">{{index + 1}}</text>
                    </view>
                </view>
            </view>
        </view>
        
        <!-- æ‹†åˆ†è¿ç®— -->
        <text class="decomposition-title">æ‹†åˆ†è¿ç®—</text>
        <view class="decomposition-container">
          <text class="diOOcZ">æŠŠæ•°å­—æ‹†æˆåä½å’Œä¸ªä½</text>
          <view class="equation">{{question.num1}} = <text class="highlight">{{visualize.tens1}}</text> + <text class="highlight">{{visualize.ones1}}</text></view>
          <view class="equation">{{question.num2}} = <text class="highlight">{{visualize.tens2}}</text> + <text class="highlight">{{visualize.ones2}}</text></view>
          <view class="parts">
            <view class="part">
              <text>åä½: {{visualize.tens1}}</text>
              <!-- åä½ç å­ -->
              <view class="tens-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9,10]}}" wx:key="index" wx:if="{{index < visualize.tens1}}" class="tens-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
              <text class="tens-label">{{visualize.tens1}}Ã—1</text>
            </view>
            <view class="part">
              <text>ä¸ªä½: {{visualize.ones1}}</text>
              <!-- ä¸ªä½ç å­ -->
              <view class="ones-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9]}}" wx:key="index" wx:if="{{index < visualize.ones1}}" class="ones-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
            </view>
            <view class="part">
              <text>åä½: {{visualize.tens2}}</text>
              <!-- åä½ç å­ -->
              <view class="tens-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9,10]}}" wx:key="index" wx:if="{{index < visualize.tens2}}" class="tens-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
              <text class="tens-label">{{visualize.tens2}}Ã—1</text>
            </view>
            <view class="part">
              <text>ä¸ªä½: {{visualize.ones2}}</text>
              <!-- ä¸ªä½ç å­ -->
              <view class="ones-beads">
                <view wx:for="{{[1,2,3,4,5,6,7,8,9]}}" wx:key="index" wx:if="{{index < visualize.ones2}}" class="ones-bead-with-number">
                  <text class="number">{{index + 1}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
        
        <!-- è®¡ç®—æ‹†åˆ†åçš„åŠ æ³• -->

          <text class="diOOcZ">è®¡ç®—æ‹†åˆ†ä¹‹åçš„åŠ æ³•</text>
            <view class="step-container">
                <view class="dKIaKw">
                    <text class="step-text">{{visualize.tens1}} + {{visualize.tens2}} = <text class="highlight">{{visualize.sumTens}}</text> (åä½ç›¸åŠ )</text>
                </view>
                <view class="dKIaKw">
                    <text class="step-text">{{visualize.ones1}} + {{visualize.ones2}} = <text class="highlight">{{visualize.sumOnes}}</text> (ä¸ªä½ç›¸åŠ )</text>
                </view>
                <view class="dKIaKw2">
                    <text class="step-text">{{visualize.sumTens}} + {{visualize.sumOnes}} = <text class="highlight">{{visualize.sumTotal}}</text> (ç»“æœ)</text>
                </view>
        </view>
        
        <!-- è§£é¢˜æ­¥éª¤ -->
        <view class="steps-container">
          <view class="steps-header">
            <text class="steps-title">è§£é¢˜æ­¥éª¤</text>
          </view>
          <view class="step-item">
            <text class="step-number">1</text>
            <text class="step-text">å°†{{question.num1}}æ‹†åˆ†ä¸º{{visualize.tens1}} + {{visualize.ones1}}ï¼Œå°†{{question.num2}}æ‹†åˆ†ä¸º{{visualize.tens2}} + {{visualize.ones2}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">2</text>
            <text class="step-text">è®¡ç®—åä½æ•°ç›¸åŠ ï¼š{{visualize.tens1}} + {{visualize.tens2}} = {{visualize.sumTens}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">3</text>
            <text class="step-text">è®¡ç®—ä¸ªä½æ•°ç›¸åŠ ï¼š{{visualize.ones1}} + {{visualize.ones2}} = {{visualize.sumOnes}}</text>
          </view>
          <view class="step-item">
            <text class="step-number">4</text>
            <text class="step-text">å°†ç»“æœç›¸åŠ ï¼š{{visualize.sumTens}} + {{visualize.sumOnes}} = {{visualize.sumTotal}}</text>
          </view>
        </view>
        
        <!-- æœ€ç»ˆç»“æœ -->
        <view class="final-result-container">
          <text class="final-result-title">æœ€ç»ˆç»“æœ</text>
          <view class="result">{{question.num1}} + {{question.num2}} = <text class="result">{{visualize.sumTotal}}</text></view>
          <!-- ç»“æœç å­ -->
          <view class="result-beads">
            <view wx:for="{{[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50]}}" wx:key="index" wx:if="{{index < visualize.sumTotal}}" class="result-bead-with-number">
              <text class="number">{{index + 1}}</text>
            </view>
          </view>
        </view>
        
        <button class="btn-change" bindtap="generateNewQuestion">æ¢ä¸€é¢˜</button>
      </view>
    </view>
  </scroll-view>
  
  <!-- å‘è€å¸ˆæé—®é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å‘è€å¸ˆæé—®'}}" class="page-container" scroll-y="{{true}}" show-scrollbar="{{false}}">
    <view class="adm-card-body">
    <!-- å›ºå®šçš„æ•°å­¦æ™ºèƒ½åŠ©æ‰‹éƒ¨åˆ† -->
    <view class="assistant-info-container">
      <view class="message assistant">
          <view class="avatar">
            <image src="/assets/AI/avatar-ass.svg"></image>
          </view>
          <view class="content">
            <text class="fJOZqM ">æ•°å­¦æ™ºèƒ½åŠ©æ‰‹ 
              <text class="status">åœ¨çº¿ï¼Œå¯ä»¥æé—®</text>
            </text>
          </view>
        </view>
    </view>

    <!-- åˆ†å‰²çº¿ 
    <view class="divider"></view>
  -->
    <!-- æ¶ˆæ¯åˆ—è¡¨éƒ¨åˆ† -->
    <view class="message-list-container">
      <view class="message-list">
        <block wx:for="{{messages}}" wx:key="index">
          <view class="message {{item.type}}">
            <!-- åŠ©æ‰‹æ¶ˆæ¯ -->
            <block wx:if="{{item.type === 'assistant'}}">
              <view class="avatar">
                <image src="/assets/AI/avatar-ass.svg"></image>
              </view>
              <view class="content">
                <text class="message-text">{{item.content}}
                  
                </text>
                <text class="time">{{item.time}}</text>
              </view>
            </block>
            <!-- ç”¨æˆ·æ¶ˆæ¯ -->
            <block wx:if="{{item.type === 'user'}}">
              <view class="content-user">
                <text class="message-text2">{{item.content}}
                  
                </text>
                <text class="time2">{{item.time}}</text>
              </view>
              <view class="userav">
                <image src="/assets/AI/user.svg" style="width: 40rpx; height: 40rpx;"></image>
              </view>
            </block>
          </view>
        </block>
      </view>
    </view>

    <!-- å›ºå®šçš„å‘é€æ¶ˆæ¯éƒ¨åˆ† -->
    <view class="input-bg">
      <view class="gzNVlp">
        <input 
           class="input" 
           placeholder="ä¾‹å¦‚ï¼šæ€ä¹ˆè®¡ç®—25+17?" 
          value="{{userMessage}}" 
          bindinput="onInput" 
         />
       </view>
       <view class="kqpWaO ">
         <image src="/assets/AI/camera.svg" style="width: 40rpx; height: 40rpx"></image>
       </view>
       <button class="btn-send" bindtap="sendMessage">å‘é€</button>
     </view>
  </view>
    <!-- çƒ­é—¨é—®é¢˜éƒ¨åˆ† -->
    <view class="hot-questions">
      <text class="bmpJRA">â­çƒ­é—¨é—®é¢˜</text>
      <view class="question-tags">
        <text class="tag" bindtap="fillInput" data-question="æ€ä¹ˆè®¡ç®—25+17?">æ€ä¹ˆè®¡ç®—25+17?</text>
        <text class="tag2" bindtap="fillInput" data-question="è¿›ä½åŠ æ³•æ€ä¹ˆç®—?">è¿›ä½åŠ æ³•æ€ä¹ˆç®—?</text>
        <text class="tag3" bindtap="fillInput" data-question="è¿åŠ é¢˜æœ‰ä»€ä¹ˆæŠ€å·§?">è¿åŠ é¢˜æœ‰ä»€ä¹ˆæŠ€å·§?</text>
        <text class="tag4" bindtap="fillInput" data-question="é€€ä½å‡æ³•æ€ä¹ˆæ•™å­©å­?">é€€ä½å‡æ³•æ€ä¹ˆæ•™å­©å­?</text>
        <text class="tag5" bindtap="fillInput" data-question="å£ç®—æœ‰å“ªäº›å¸¸è§é”™è¯¯?">å£ç®—æœ‰å“ªäº›å¸¸è§é”™è¯¯?</text>
        <text class="tag6" bindtap="fillInput" data-question="å¦‚ä½•æé«˜è®¡ç®—é€Ÿåº¦?">å¦‚ä½•æé«˜è®¡ç®—é€Ÿåº¦?</text>
      </view>
    </view>
  </scroll-view>
  
  <!-- å­¦ä¹ è¿›åº¦é¡µé¢ -->
  <scroll-view wx:if="{{currentPage === 'å­¦ä¹ è¿›åº¦'}}" class="page-container" scroll-y="{{true}}" show-scrollbar="{{false}}">
    <!-- å­¦ä¹ è¿›åº¦é¡µé¢å†…å®¹ -->
    <view class="progress-container">
      <!-- ä¸ªäººå­¦ä¹ è¿›åº¦ -->
      <view class="personal-progress">
        <text class="section-title">ğŸ‘¤ä¸ªäººå­¦ä¹ è¿›åº¦</text>
        <!-- æ€»ä½“ -->
        <view class="progress-item">
          <image src="/assets/ai/star.svg" style="width: 15px; height: 15px;"></image>
          <text class="progress-label">æ€»ä½“æŒæ¡åº¦ <text class="lhUXcF">{{progress.overall}}%</text></text>
          <view class="evsnlc "></view>
        </view>
        
        <!-- åŠ æ³•  -->
        <view class="progress-item2">
          <image src="/assets/ai/math-icon.svg" style="width: 10px; height: 10px;"></image>
          <text class="bpfJac">åŠ æ³•è¿›ä½ <text class="lhUXcF">{{progress.addition}}%</text></text>
          <view class="evsnlc2 "></view>
          <!-- #endif <text class="progress-percent">{{progress.addition}}%</text> -->
        </view>
        
        <!-- è¿åŠ   -->
        <view class="progress-item2">
          <image src="/assets/ai/math-icon.svg" style="width: 10px; height: 10px;"></image>
          <text class="bpfJac">è¿åŠ è¿å‡ <text class="lhUXcF2">{{progress.consecutive}}%</text></text>
          <view class="evsnlc3 "></view>
          <!-- 
            <progress percent="{{progress.consecutive}}" show-info="{{true}}" active="{{false}}" />
            <text class="progress-percent">{{progress.consecutive}}%</text> 
          -->
        </view>

        <!-- ä¹˜æ³•  -->
        <view class="progress-item2">
          <image src="/assets/ai/math-icon.svg" style="width: 10px; height: 10px;"></image>
          <text class="bpfJac">ä¹˜æ³•å£è¯€ <text class="lhUXcF3">{{progress.multiplication}}%</text></text>
          <view class="evsnlc4 "></view>
          <!-- 
             <progress percent="{{progress.multiplication}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.multiplication}}%</text>
          -->
        </view>

        <!-- ğŸ—Šåº”ç”¨é¢˜è§£æ  -->
        <view class="progress-item2">
          <image src="/assets/ai/math-icon.svg" style="width: 10px; height: 10px;"></image>
          <text class="bpfJac">åº”ç”¨é¢˜è§£æ <text class="lhUXcF4">{{progress.application}}%</text></text>
          <view class="evsnlc5 "></view>
          <!-- 
            <progress percent="{{progress.application}}" show-info="{{true}}" active="{{false}}" />
          <text class="progress-percent">{{progress.application}}%</text>
          -->
        </view>
      </view>
    </view>
    
      <!-- ä¸­é—´éš”å¼€éƒ¨åˆ† 
        <view class="separator"></view>
      -->
    
    
    <view class="challenge2">
      <!-- ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’ -->
      <view class="learning-plan">
        <text class="section-title">â­ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’</text>
        
        <view class="recommended-paths">
          <image src="/assets/ai/progect.svg" style="width: 15px; height: 15px; color: rgb(22, 119, 255);"></image>
          <text class="path-title">  æ¨èå­¦ä¹ è·¯å¾„</text>
          
          <view class="path-item status-in-progress">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/ai/math-icon.svg" style="width: 40rpx; height: 40rpx;"></image>
              </view>
              <view class="path-info">
                <text class="path-name">åŠ æ³•è¿›ä½ä¸“é¢˜</text>
                <view>
                  <text class="bDsqBI">è¿›è¡Œä¸­ 3/5</text>
                </view>
                <text class="path-description">æŒæ¡åŠ æ³•è¿›ä½çš„åŸç†å’Œæ–¹æ³•</text>
              </view>
            </view>
            <view class="btn-continue" bindtap="onContinueLearning">ç»§ç»­å­¦ä¹ </view>
          </view>
          
          <view class="path-item status-in-progress">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/ai/math-icon.svg" style="width: 40rpx; height: 40rpx;"></image>
              </view>
              <view class="path-info">
                <text class="path-name">é€€ä½å‡æ³•ä¸“é¢˜</text>
                <view>
                  <text class="bDsqBI">è¿›è¡Œä¸­ 1/5</text>
                </view>
                <text class="path-description">å­¦ä¹ é€€ä½å‡æ³•çš„è®¡ç®—æŠ€å·§</text>
              </view>
            </view>
            <view class="btn-continue" bindtap="onStartLearning">ç»§ç»­å­¦ä¹ </view>
          </view>
          
          <view class="path-item status-not-started">
            <view class="path-info-container">
              <view class="path-info-icon">
                <image src="/assets/ai/math-icon.svg" style="width: 40rpx; height: 40rpx;"></image>
              </view>
              <view class="path-info">
                <text class="path-name">æ··åˆè¿ç®—ä¸“é¢˜</text>
                <view class="">
                  <text class="kRGDSX">æœªå¼€å§‹</text>
                </view>
                <text class="path-description">ç»¼åˆè¿ç”¨åŠ å‡æ³•è§£å†³é—®é¢˜</text>
              </view>
            </view>
            <view class="btn-start" bindtap="onStartLearning">å¼€å§‹å­¦ä¹ </view>
          </view>
        </view>
        
        <view class="btn-full-plan" bindtap="onStartLearning">æŸ¥çœ‹å®Œæ•´å­¦ä¹ è®¡åˆ’</view>
      </view>
    </view>
  </scroll-view>
</view>